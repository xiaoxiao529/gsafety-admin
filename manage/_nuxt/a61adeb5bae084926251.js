(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1169:function(e,t,o){"use strict";o.r(t);o(33),o(2),o(3),o(4),o(5);var l=o(478),r=(o(26),{components:{Pagination:l.a},data:function(){return{btns:[{name:"上传",isShow:!1},{name:"删除",isShow:!1},{name:"下载",isShow:!1}],currentBtns:[],isLoading:!1,labelPosition:"top",userObj:{},formData:{fileId:"",fileName:"",createFileTime:"",startTime:"",endTime:""},tableData:[],loading:!0,labelWidth:"100px",widgetInfo:{pageSize:10,pageNo:1,total:0},dialogVisible:!1,dialogDelVisible:!1,delId:"",ruleForm:{attachmentName:"",remarks:"",fileUrl:"",fileList:[],uploadFile:""},rules:{attachmentName:[{required:!0,message:"请输入附件名称",trigger:"blur"}]}}},mounted:function(){this.userObj=this._Storage.getObj("userObj","userObj"),this.currentBtns=this._Storage.getObj("currentBtnArr","currentBtnArr"),this.isBtnShow()},computed:{},methods:{addNewFileDiglog:function(){this.dialogVisible=!0},downloadAttachment:function(e,t){var o=this;this.$confirm("确定要下载吗?","下载提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){window.open("/gsafetyclound/user-center-service/enclosureManage/downAttachment?fileId="+e.id)}).catch(function(e){o.$message({type:"warning",message:"取消下载!"})})},deleteAttachment:function(e,t){this.dialogDelVisible=!0,this.delId=e.id},sureHandle:function(){var e=this;this.isLoading=!0,this.$axios.$POST({api_name:"deleteEnclosureManageInfoById",params:{id:this.delId}}).then(function(t){"success"==t.data.code?(e.isLoading=!1,e.dialogDelVisible=!1,e.$message({message:t.data.rspMsg,type:"success"}),e.getAttachmentListPage()):(e.isLoading=!1,e.dialogDelVisible=!1,e.$message({message:t.data.rspMsg,type:"error"}))})},cancalHandle:function(){this.dialogDelVisible=!1,this.$message("取消删除操作")},getAttachmentListPage:function(){var e=this;e.isLoading=!0,e.$axios.$POST({api_name:"findEnclosureManageList",params:{fileId:e.formData.fileId,fileName:e.formData.fileName,startTime:e.formData.startTime,endTime:e.formData.endTime,pageNo:e.widgetInfo.pageNo,pageSize:e.widgetInfo.pageSize}}).then(function(t){if("success"==t.data.code){e.isLoading=!1;var o=t.data.data;e.tableData=o.rows,e.widgetInfo.total=null===o.total?0:o.total}else e.tableData=[],e.widgetInfo.list=data.rows,e.widgetInfo.total=0,console.log("没有数值。。。。。")})},sonHandleCurrentChange:function(e){this.widgetInfo.pageSize=e.pageSize?parseInt(e.pageSize):this.widgetInfo.pageSize,this.widgetInfo.pageNo=e.pageNo?parseInt(e.pageNo):this.widgetInfo.pageNo,this.getAttachmentListPage()},reset:function(e){this.formData={},this.getAttachmentListPage()},lookFor:function(){this.formData.createFileTime?(this.formData.startTime=this.formData.createFileTime[0],this.formData.endTime=this.formData.createFileTime[1]):(this.formData.startTime="",this.formData.endTime=""),this.getAttachmentListPage()},submitForm:function(e){var t=this,o=this;o.isLoading=!0,this.$refs[e].validate(function(e){if(!e||!t.ruleForm.fileUrl)return o.$message({message:"请输入附件名称并且上传附件!",type:"error"}),o.isLoading=!1,!1;o.$axios.$POST({api_name:"addEnclosureManageInfo",params:{fileUrl:o.ruleForm.fileUrl,userId:o.userObj.id,userName:o.userObj.userName,remarks:o.ruleForm.remarks,fileName:o.ruleForm.attachmentName}}).then(function(e){"success"==e.data.code?(o.isLoading=!1,o.dialogVisible=!1,o.ruleForm.remarks="",o.ruleForm.attachmentName="",o.ruleForm.fileList=[],o.ruleForm.fileUrl="",o.$message({message:e.data.rspMsg,type:"success"}),o.getAttachmentListPage()):(o.isLoading=!1,o.dialogVisible=!1,o.$message({message:e.data.rspMsg,type:"error"}))})})},cancelForm:function(e){this.ruleForm={},this.dialogVisible=!1,this.$message("取消上传操作")},handleRemove:function(e,t){console.log(e,t),this.ruleForm.fileList=[],this.ruleForm.fileUrl=""},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("每次最多上传 1 个文件!")},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},handleFileSuccess:function(e,t){"success"==e.code&&(this.ruleForm.fileUrl=e.data.url)},handleFileError:function(e,t,o){console.log(e,t,o)},closeDialog:function(){this.ruleForm.remarks="",this.ruleForm.attachmentName="",this.ruleForm.fileList=[],this.ruleForm.fileUrl=""},isBtnShow:function(){var e=this.currentBtns;this.btns.forEach(function(element){e.forEach(function(e){console.log(e),e.name===element.name&&(element.isShow=e.isShow)})})}}}),n=(o(768),o(770),o(17)),component=Object(n.a)(r,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"Crumbs"},[o("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[o("el-breadcrumb-item",[e._v("硬件平台")]),e._v(" "),o("el-breadcrumb-item",[e._v("附件管理")])],1)],1),e._v(" "),o("div",{staticClass:"main-wrap"},[o("el-row",{staticClass:"location"},[o("el-col",{attrs:{span:12}},[o("h3",[e._v("附件管理")])]),e._v(" "),o("el-col",{staticClass:"add-btn-style",attrs:{span:12}},[o("el-button",{directives:[{name:"show",rawName:"v-show",value:e.btns[0].isShow,expression:"btns[0].isShow"}],attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.addNewFileDiglog()}}},[e._v("上传新附件")])],1)],1),e._v(" "),o("div",{staticClass:"main-container"},[o("el-form",{ref:"formData",staticClass:"hardware-form",attrs:{inline:!0,model:e.formData}},[o("el-form-item",{attrs:{label:"附件ID:","label-width":e.labelWidth}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formData.fileId,callback:function(t){e.$set(e.formData,"fileId",t)},expression:"formData.fileId"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"附件名称:","label-width":e.labelWidth}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formData.fileName,callback:function(t){e.$set(e.formData,"fileName",t)},expression:"formData.fileName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"创建时间:","label-width":"180px"}},[o("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.formData.createFileTime,callback:function(t){e.$set(e.formData,"createFileTime",t)},expression:"formData.createFileTime"}})],1),e._v(" "),o("el-form-item",{staticStyle:{"text-align":"right"},attrs:{label:" "}},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.lookFor()}}},[e._v("查询")]),e._v(" "),o("el-button",{attrs:{size:"small"},on:{click:function(t){return e.reset("formData")}}},[e._v("重置")])],1)],1),e._v(" "),o("div",{staticClass:"list-wrap"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading.lock",value:e.isLoading,expression:"isLoading",modifiers:{lock:!0}}],attrs:{data:e.tableData,stripe:"","show-overflow-tooltip":""}},[o("el-table-column",{attrs:{label:"附件ID",prop:"id","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:"附件名称",prop:"fileName","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:"创建人",prop:"createByUsername","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:"创建时间",prop:"createTime","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:"备注",prop:"remarks","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{label:"操作","show-overflow-tooltip":"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-link",{directives:[{name:"show",rawName:"v-show",value:e.btns[1].isShow,expression:"btns[1].isShow"}],attrs:{type:"primary"},on:{click:function(o){return e.deleteAttachment(t.row,t.$index)}}},[e._v("删除")]),e._v(" "),o("el-link",{directives:[{name:"show",rawName:"v-show",value:e.btns[2].isShow,expression:"btns[2].isShow"}],attrs:{type:"primary"},on:{click:function(o){return e.downloadAttachment(t.row,t.$index)}}},[e._v("下载")])]}}])})],1),e._v(" "),o("Pagination",{attrs:{widgetInfo:e.widgetInfo},on:{sonHandleCurrentChange:e.sonHandleCurrentChange}})],1)],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"附件上传",visible:e.dialogVisible,width:"530px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.closeDialog}},[o("div",{staticClass:"dialog-body-diy-wrapper"},[o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"附件名称",prop:"attachmentName"}},[o("el-input",{model:{value:e.ruleForm.attachmentName,callback:function(t){e.$set(e.ruleForm,"attachmentName",t)},expression:"ruleForm.attachmentName"}})],1),e._v(" "),o("p",{staticClass:"dot"},[e._v("*")]),e._v(" "),o("el-form-item",{attrs:{label:"上传附件",prop:"uploadFile"}},[o("el-upload",{staticClass:"upload-demo",attrs:{action:"/gsafetyclound/user-center-service/enclosureManage/uploadfile","before-remove":e.beforeRemove,limit:1,"file-list":e.ruleForm.fileList,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-error":e.handleFileError,"on-success":e.handleFileSuccess,"on-exceed":e.handleExceed}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[o("el-input",{attrs:{type:"textarea",rows:4},model:{value:e.ruleForm.remarks,callback:function(t){e.$set(e.ruleForm,"remarks",t)},expression:"ruleForm.remarks"}})],1)],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确 定")]),e._v(" "),o("el-button",{on:{click:function(t){return e.cancelForm("ruleForm")}}},[e._v("取 消")])],1)]),e._v(" "),o("el-dialog",{attrs:{"custom-class":"del-dialog-wrap",visible:e.dialogDelVisible,width:"280px"},on:{"update:visible":function(t){e.dialogDelVisible=t}}},[o("div",{staticClass:"del-dialog-main"},[o("div",{staticClass:"icon-wrap"},[o("i",{staticClass:"el-icon-s-opportunity"})]),e._v(" "),o("div",{staticClass:"p-wrap"},[o("p",{staticClass:"title-p"},[e._v("是否确定删除？")]),e._v(" "),o("p",{staticClass:"tips-p"},[e._v("删除后将不可恢复")])])]),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.sureHandle}},[e._v("确 定")]),e._v(" "),o("el-button",{on:{click:e.cancalHandle}},[e._v("取 消")])],1)])],1)},[],!1,null,"5092ef52",null);t.default=component.exports},478:function(e,t,o){"use strict";o(2),o(3),o(4),o(5);var l={props:{widgetInfo:Object},data:function(){return{}},methods:{handleSizeChange:function(e){this.pageSize=e,this.$emit("sonHandleCurrentChange",{pageSize:this.pageSize})},handleCurrentChange:function(e){this.$emit("sonHandleCurrentChange",{pageNo:e})}},mounted:function(){this.$emit("sonHandleCurrentChange",{pageSize:10,pageNo:1})}},r=o(17),component=Object(r.a)(l,function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-pagination",{attrs:{"current-page":this.widgetInfo.pageNo,"page-sizes":[10,15,20,25],"page-size":this.widgetInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:this.widgetInfo.total},on:{"size-change":this.handleSizeChange,"current-change":this.handleCurrentChange}})],1)},[],!1,null,null,null);t.a=component.exports},588:function(e,t,o){var content=o(769);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(14).default)("6eb37abf",content,!0,{sourceMap:!1})},589:function(e,t,o){var content=o(771);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(14).default)("502da554",content,!0,{sourceMap:!1})},768:function(e,t,o){"use strict";var l=o(588);o.n(l).a},769:function(e,t,o){(e.exports=o(13)(!1)).push([e.i,".record-table[data-v-5092ef52]{height:400px}.dot[data-v-5092ef52]{color:#f56c6c;font-size:14px;position:absolute;top:140px}.add-btn-style[data-v-5092ef52]{text-align:right;padding-right:25px;box-sizing:border-box}.list-wrap[data-v-5092ef52]{overflow:hidden}.list-wrap[data-v-5092ef52] .el-table{padding:0;overflow:hidden}.list-wrap[data-v-5092ef52] .el-table th{background:#f0f3f7}.list-wrap[data-v-5092ef52] .el-table .el-table__body-wrapper{height:calc(100vh - 448px);overflow-y:auto}.hardware-form .el-form-item[data-v-5092ef52]{width:24%;display:-webkit-inline-box;display:inline-flex;margin-right:0}.hardware-form .el-form-item[data-v-5092ef52]:nth-of-type(3){width:33%}.hardware-form .el-form-item[data-v-5092ef52]:last-of-type{width:15%}.hardware-form[data-v-5092ef52]{padding-left:25px}@media screen and (max-width:1680px){.list-wrap[data-v-5092ef52] .el-table .el-table__body-wrapper{height:calc(100vh - 415px)}}",""])},770:function(e,t,o){"use strict";var l=o(589);o.n(l).a},771:function(e,t,o){(e.exports=o(13)(!1)).push([e.i,".el-scrollbar__wrap{overflow-x:hidden}",""])}}]);