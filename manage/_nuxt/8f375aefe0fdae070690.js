(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{1171:function(e,t,n){"use strict";n.r(t);n(242),n(101),n(2),n(3),n(4),n(5);var o={components:{Pagination:n(478).a},data:function(){return{flag:!1,isLoading:!1,labelWidth:"140px",cancelUserId:{},roles:[{value:"",label:"全部"}],units:[{value:" ",label:"全部"}],onlineStates:[{value:"",label:"全部"},{value:0,label:"启用"},{value:1,label:"禁用"}],formData:{},tableData:[],loading:!0,pageNo:1,pageSize:6,total:0,widgetInfo:{pageSize:6,pageNo:1,total:0},indexNum:0,userId:null,parentTypeNameList:[],plan:{},dialogVisible:!1,clickModal:!1,labelPosition:"top",optTitle:null,optMode:null,rules:{loginName:[{required:!0,message:"登录账号不能为空",trigger:"blur"},{min:1,max:16,message:"长度在 1 到 16 个字符",trigger:"blur"},{pattern:/^\w+$/,message:"请输入英文、数字、下划线"}],id:[{required:!0,message:"请选择系统角色",trigger:"change"}],userName:[{required:!0,message:"用户名称不能为空",trigger:"blur"},{min:1,max:16,message:"长度在 1 到 16 个字符",trigger:"blur"}],userTelphone:[{required:!0,message:"手机号不能为空",trigger:"blur"},{pattern:/^1[3|4|5|7|8][0-9]\d{8}$/,message:"请输入正确的手机号"}]}}},created:function(){this.format()},mounted:function(){this.cancelUserId=this._Storage.getObj("userObj","userObj")},computed:{transformOnlineState:function(e){return function(e){return 0==e?"启用":1==e?"禁用":void 0}},transformOnlineName:function(e){return function(e){return 1==e?"启用":0==e?"禁用":void 0}}},methods:{changeSubCode:function(){},findMonitorDeviceStateDownList:function(){var e=this;this.isLoading=!0,this.$axios.$POST({api_name:"findUserListBySysCodeAndOrgCode",params:{sysCode:"manager",orgCode:"",userTelphone:this.formData.userTelphone,userName:this.formData.userName,loginName:this.formData.loginName,authStatus:this.formData.authStatus,pageNo:this.widgetInfo.pageNo,pageSize:this.widgetInfo.pageSize}}).then(function(t){if("success"==t.data.code){e.isLoading=!1;var data=t.data.data;e.tableData=data.rows,e.widgetInfo.total=null===data.total?0:data.total}else e.tableData=[],e.widgetInfo.list=data.rows,e.widgetInfo.total=0})},sonHandleCurrentChange:function(e){this.widgetInfo.pageSize=e.pageSize?parseInt(e.pageSize):this.widgetInfo.pageSize,this.widgetInfo.pageNo=e.pageNo?parseInt(e.pageNo):this.widgetInfo.pageNo,this.findMonitorDeviceStateDownList()},dialogForm_delRows:function(e){var t=this,n=this;this.$confirm("确认删除该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.isLoading=!0,t.$axios.$POST({api_name:"deleteUser",params:{userId:e.id}}).then(function(e){t.isLoading=!1,t.$message.success(e.data.message),"success"==e.data.code&&(n.lookFor(),n.$router.go(0))})})},pswReset:function(e){var t=this;this.$confirm("确认重置该用户密码为a123456","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.isLoading=!0,t.$axios.$POST({api_name:"resetPasswordByUserId",params:{userId:e.id}}).then(function(e){t.isLoading=!1,t.$message.success(e.data.message)})}).catch(function(e){console.log(e)})},addOrEditDiglog:function(e,t){var n=this;n.dialogVisible=!0,n.optMode=e,n.findRoleListBySysCodeAndPager(),"add"==e?(n.optTitle="新增",n.$nextTick(function(){n.plan={},n.$refs.plan.resetFields()})):(n.$nextTick(function(){n.plan=JSON.parse(JSON.stringify(t)),n.$refs.plan.resetFields()}),n.optTitle="编辑",n.plan=JSON.parse(JSON.stringify(t)),n.userId=t.id,n.$axios.$POST({api_name:"findUserByUserId",params:{userId:t.id},time:3e4}).then(function(e){"success"==e.data.code?n.plan.id=e.data.data.userAuthList[0].authRoleList[0].roleId:n.$message.error("查询用户系统角色失败")}))},changeState:function(e){var t=this,n=this;0==e.userAuthStatus?this.$confirm("确认禁用该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.isLoading=!0;var o=(new Date).Format("yyyy-MM-dd HH:mm:ss");t.$axios.$POST({api_name:"cancelUserByUserId",params:{userId:e.id,cancelTime:o,cancelUserId:n.cancelUserId.id}}).then(function(e){t.isLoading=!1,"success"==e.data.code?(t.$message.success("禁用成功"),n.lookFor()):t.$message.error(e.data.message)})}).catch(function(e){console.log(e)}):1==e.userAuthStatus&&this.$confirm("确认启用该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.isLoading=!0,t.$axios.$POST({api_name:"restoreUserByUserId",params:{userId:e.id,restoreUserId:n.cancelUserId.id}}).then(function(e){t.isLoading=!1,"success"==e.data.code?(t.$message.success("启用成功"),n.lookFor()):t.$message.error(e.data.message)})})},findRoleListBySysCodeAndPager:function(){var e=this;e.isLoading=!0,e.$axios.$POST({api_name:"findRoleListBySysCodeAndPager",params:{sysCode:"manager",orgCode:"03_DEFAULT"}}).then(function(t){if(e.isLoading=!1,"success"==t.data.code){var data=t.data.data.rows;e.parentTypeNameList=data}else e.parentTypeNameList=[],e.$message.error(t.data.message)}).catch(function(){e.$message.error("用户角色下拉异常")})},reset:function(){this.formData={},this.findMonitorDeviceStateDownList()},lookFor:function(){this.findMonitorDeviceStateDownList()},handleClose:function(){var e=this;e.dialogVisible=!1,e.$nextTick(function(){e.plan={},e.$refs.plan.resetFields()})},saveOrUpdateForm:function(e){var t=this;"add"==t.optMode?t.$refs[e].validate(function(e){if(!e)return!1;var n=t._Storage.getObj("userObj","userObj").id;t.$axios.$POST({api_name:"addUser",params:{userName:t.plan.userName,loginName:t.plan.loginName,userTelphone:t.plan.userTelphone,roleIds:t.plan.id,createUserId:n,dataRes:"manager",password:"a123456",sysCode:"manager",orgCode:"03_DEFAULT"}}).then(function(e){t.isLoading=!1,t.handleClose(),"success"==e.data.code?(t.$message.success(e.data.message),t.lookFor()):t.$message.error(e.data.message)}).catch(function(){t.$message.error("新增用户异常")})}):"edit"==t.optMode&&t.$refs[e].validate(function(e){if(!e)return!1;var n=t._Storage.getObj("userObj","userObj").id;t.$axios.$POST({api_name:"modifyUser",params:{userName:t.plan.userName,loginName:t.plan.loginName,userTelphone:t.plan.userTelphone,roleIds:t.plan.id,id:t.userId,updateUserId:n,dataRes:"manager",password:"a123456",sysCode:"manager",orgCode:"03_DEFAULT"}}).then(function(e){t.isLoading=!1,t.handleClose(),"success"==e.data.code?(t.$message.success(e.data.message),t.lookFor(),t.$router.go(0)):t.$message.error(e.data.message)}).catch(function(){t.$message.error("修改用户信息异常")})})},format:function(){Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"S+":this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr(String(t[n]).length)));return e}}}},r=(n(828),n(17)),component=Object(r.a)(o,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"Crumbs"},[n("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[n("el-breadcrumb-item",[e._v("系统配置")]),e._v(" "),n("el-breadcrumb-item",[e._v("用户管理")])],1)],1),e._v(" "),n("div",{staticClass:"main-wrap"},[n("el-row",{staticClass:"location"},[n("el-col",{attrs:{span:12}},[n("h3",[e._v("用户管理")])]),e._v(" "),n("el-col",{staticClass:"add-btn-style",attrs:{span:12}},[n("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(t){return e.addOrEditDiglog("add")}}},[e._v("新增")])],1)],1),e._v(" "),n("div",{staticClass:"main-container"},[n("el-form",{ref:"formData",staticClass:"hardware-form",attrs:{inline:!0,model:e.formData}},[n("el-form-item",{attrs:{label:"登录账号:",prop:"loginName","label-width":e.labelWidth}},[n("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formData.loginName,callback:function(t){e.$set(e.formData,"loginName","string"==typeof t?t.trim():t)},expression:"formData.loginName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"用户名称:",prop:"userName","label-width":e.labelWidth}},[n("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formData.userName,callback:function(t){e.$set(e.formData,"userName","string"==typeof t?t.trim():t)},expression:"formData.userName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"手机号:",prop:"userTelphone","label-width":e.labelWidth}},[n("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formData.userTelphone,callback:function(t){e.$set(e.formData,"userTelphone","string"==typeof t?t.trim():t)},expression:"formData.userTelphone"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"用户状态:","label-width":e.labelWidth}},[n("el-select",{attrs:{placeholder:"全部",filterable:""},model:{value:e.formData.authStatus,callback:function(t){e.$set(e.formData,"authStatus","string"==typeof t?t.trim():t)},expression:"formData.authStatus"}},e._l(e.onlineStates,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),n("el-form-item",{staticClass:"serch-btn",attrs:{label:""}},[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.lookFor()}}},[e._v("查询")]),e._v(" "),n("el-button",{attrs:{size:"small"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)],1),e._v(" "),n("div",{staticClass:"list-wrap"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading.lock",value:e.isLoading,expression:"isLoading",modifiers:{lock:!0}}],attrs:{data:e.tableData,stripe:"","show-overflow-tooltip":""}},[n("el-table-column",{attrs:{label:"用户ID",width:"290",prop:"id","show-overflow-tooltip":"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{label:"登录账号",prop:"loginName","show-overflow-tooltip":"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{label:"用户名称",prop:"userName","show-overflow-tooltip":"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{label:"手机号",prop:"userTelphone","show-overflow-tooltip":"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{label:"创建时间",prop:"createTime","show-overflow-tooltip":"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{label:"用户状态",prop:"userAuthStatus","show-overflow-tooltip":"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[e._v(e._s(e.transformOnlineState(t.row.userAuthStatus)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"操作","show-overflow-tooltip":"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-link",{attrs:{type:"primary"},on:{click:function(n){return e.addOrEditDiglog("edit",t.row)}}},[e._v("编辑")]),e._v(" "),n("el-link",{attrs:{type:"primary"},on:{click:function(n){return e.changeState(t.row)}}},[e._v(e._s(e.transformOnlineName(t.row.userAuthStatus)))]),e._v(" "),n("el-link",{attrs:{type:"primary"},on:{click:function(n){return e.pswReset(t.row)}}},[e._v("密码重置")])]}}])})],1),e._v(" "),n("Pagination",{attrs:{widgetInfo:e.widgetInfo},on:{sonHandleCurrentChange:e.sonHandleCurrentChange}})],1)],1)],1),e._v(" "),n("el-dialog",{attrs:{title:e.optTitle,visible:e.dialogVisible,width:"650px","close-on-click-modal":e.clickModal},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("div",{staticClass:"dialog-body-diy-wrapper"},[n("el-form",{ref:"plan",staticClass:"dialog-form-style",attrs:{"label-position":e.labelPosition,"label-width":"130px",rules:e.rules,model:e.plan}},[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"登录账号",prop:"loginName"}},[n("el-input",{attrs:{placeholder:"1-16位由英文、数字、下划线组成的账号",maxlength:"16"},model:{value:e.plan.loginName,callback:function(t){e.$set(e.plan,"loginName","string"==typeof t?t.trim():t)},expression:"plan.loginName"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"用户名称",prop:"userName"}},[n("el-input",{attrs:{maxlength:"16"},model:{value:e.plan.userName,callback:function(t){e.$set(e.plan,"userName","string"==typeof t?t.trim():t)},expression:"plan.userName"}})],1)],1)],1),e._v(" "),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"手机号",prop:"userTelphone"}},[n("el-input",{model:{value:e.plan.userTelphone,callback:function(t){e.$set(e.plan,"userTelphone","string"==typeof t?t.trim():t)},expression:"plan.userTelphone"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"系统角色",prop:"id",required:""}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.plan.id,callback:function(t){e.$set(e.plan,"id",t)},expression:"plan.id"}},e._l(e.parentTypeNameList,function(e){return n("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})}),1)],1)],1)],1)],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveOrUpdateForm("plan")}}},[e._v("确 定")])],1)])],1)},[],!1,null,"15acd99a",null);t.default=component.exports},478:function(e,t,n){"use strict";n(2),n(3),n(4),n(5);var o={props:{widgetInfo:Object},data:function(){return{}},methods:{handleSizeChange:function(e){this.pageSize=e,this.$emit("sonHandleCurrentChange",{pageSize:this.pageSize})},handleCurrentChange:function(e){this.$emit("sonHandleCurrentChange",{pageNo:e})}},mounted:function(){this.$emit("sonHandleCurrentChange",{pageSize:10,pageNo:1})}},r=n(17),component=Object(r.a)(o,function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-pagination",{attrs:{"current-page":this.widgetInfo.pageNo,"page-sizes":[10,15,20,25],"page-size":this.widgetInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:this.widgetInfo.total},on:{"size-change":this.handleSizeChange,"current-change":this.handleCurrentChange}})],1)},[],!1,null,null,null);t.a=component.exports},621:function(e,t,n){var content=n(829);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(14).default)("b1af7860",content,!0,{sourceMap:!1})},828:function(e,t,n){"use strict";var o=n(621);n.n(o).a},829:function(e,t,n){(e.exports=n(13)(!1)).push([e.i,".list-wrap[data-v-15acd99a],.list-wrap[data-v-15acd99a] .el-table{width:100%}.list-wrap[data-v-15acd99a] .el-table .el-table__body-wrapper{height:calc(100vh - 430px)}.hardware-form[data-v-15acd99a]{font-size:0;padding:20px 20px 0}.hardware-form .el-form-item[data-v-15acd99a]{width:20%;display:-webkit-inline-box;display:inline-flex;margin-right:0}.hardware-form .el-form-item .el-select[data-v-15acd99a]{width:100%}.hardware-form .serch-btn button[data-v-15acd99a]:first-child{margin-left:10px}[data-v-15acd99a] .el-pagination{margin:0;padding-top:20px}@media screen and (max-width:1680px){.list-wrap[data-v-15acd99a] .el-table .el-table__body-wrapper{height:calc(100vh - 410px)}}.add-btn-style[data-v-15acd99a]{text-align:right;padding-right:25px;box-sizing:border-box}.hardware-form[data-v-15acd99a]{padding:20px 25px 0}.list-wrap[data-v-15acd99a]{height:calc(100vh - 315px);overflow:hidden}.list-wrap[data-v-15acd99a] .el-table{padding:0;overflow:hidden}.list-wrap[data-v-15acd99a] .el-table th{background:#f0f3f7}.list-wrap[data-v-15acd99a] .el-table .el-table__body-wrapper{height:calc(100vh - 448px);overflow-y:auto}",""])}}]);