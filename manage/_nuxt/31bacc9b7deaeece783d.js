(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1159:function(e,t,o){"use strict";o.r(t);o(33),o(2),o(3),o(4),o(5);var n={components:{Pagination:o(478).a},data:function(){return{btns:[{name:"获取协议/参数",isShow:!1},{name:"下行",isShow:!1}],currentBtns:[],flag:!1,isLoading:!1,labelWidth:"100px",subCenterNames:[{value:"",label:"全部"}],units:[{value:" ",label:"全部"}],onlineStates:[{value:"",label:"全部"},{value:0,label:"离线"},{value:1,label:"在线"},{value:2,label:"未接入"}],brands:[{value:"",label:"全部"},{value:"河南力安",label:"河南力安"},{value:"北京乐鸟",label:"北京乐鸟"}],formData:{},tableData:[],loading:!0,pageNo:1,pageSize:6,total:0,widgetInfo:{pageSize:6,pageNo:1,total:0},indexNum:0}},created:function(){this.findSubCenterValue()},computed:{transformOnlineState:function(e){return function(e){return 0==e?"离线":1==e?"在线":2==e?"未接入":void 0}},transformExist:function(e){return function(e){return 0==e?" ":1==e?"已存在":void 0}}},mounted:function(){this.currentBtns=this._Storage.getObj("currentBtnArr","currentBtnArr"),this.isBtnShow()},methods:{changeSubCode:function(){this.findUnitValue()},findMonitorDeviceStateDownList:function(){var e=this;this.isLoading=!0,this.$axios.$POST({api_name:"findMonitorDeviceStateDownList",params:{deviceId:this.formData.deviceId,subCenterCode:this.formData.subCenterCode,unitId:this.formData.unit,deviceAddress:this.formData.deviceAddress,deviceName:this.formData.deviceName,brand:this.formData.brand,model:this.formData.model,onlineState:this.formData.onlineState,createTime:this.formData.createTime,exist:this.formData.exist,pageNo:this.widgetInfo.pageNo,pageSize:this.widgetInfo.pageSize}}).then(function(t){if("success"==t.data.code){e.isLoading=!1;var data=t.data.data;e.tableData=data.rows,e.widgetInfo.total=null===data.total?0:data.total}else e.tableData=[],e.widgetInfo.list=data.rows,e.widgetInfo.total=0,console.log("没有数值。。。。。")})},findUnitValue:function(){var e=this;this.$axios.$POST({api_name:"findUnitValue",params:{subCenterCode:this.formData.subCenterCode}}).then(function(t){if("success"==t.data.code){e.units=[];var o;for(var n in o=t.data.data){var l={};l.value=o[n].value,l.label=o[n].label,e.units.push(l)}}else console.log("没有数值。。。。。")})},findSubCenterValue:function(){var e=this;this.$axios.$POST({api_name:"findSubCenterValue"}).then(function(t){if("success"==t.data.code){var o;for(var n in o=t.data.data){var l={};l.value=o[n].value,l.label=o[n].label,e.subCenterNames.push(l)}}})},toDetail:function(e,t){this._Storage.setObj("downListRow","obj",t),this.$router.push({name:"downLine-downlinkControlDetail",params:{row:t}})},getParameter:function(e,t){var o=this,n={monitorId:e.id,controlHost:e.controlHost,sourceId:e.sourceId,operationType:"4",operationItemType:"",dataValue:""},l={monitorId:e.id,controlHost:e.controlHost,sourceId:e.sourceId,commandType:"2"};"hnla"==e.sourceId?this.$axios.$POST({api_name:"hnlaSendDown",params:n}).then(function(t){if("success"==t.data.code){if(t.data.data){var l=t.data.data.statue;if("1"==l){e.exist;var r=o;r.indexNum++,setTimeout(function(){r.getParameterAgain("hnla","hnlaSendDown",e,n)},5e3),o.$message({message:"命令发送成功",type:"success"})}else"2"==l?o.$message({message:"设备不在线或者未接入",type:"warning"}):"3"==l&&o.$message({message:"参数无效",type:"error"})}}else o.$message("获取失败")}):"bjlnUDP"==e.sourceId&&this.$axios.$POST({api_name:"sendCommand",params:l}).then(function(t){if("success"==t.data.code){if(t.data.data){var n=t.data.data.state;if("1"==n){e.exist;var r=o;r.indexNum++,setTimeout(function(){r.getParameterAgain("bjlnUDP","sendCommand",e,l)},5e3),o.$message({message:"命令发送成功",type:"success"})}else"2"==n?o.$message({message:"设备不在线或者未接入",type:"warning"}):"3"==n&&o.$message({message:"参数无效",type:"error"})}}else o.$message("获取失败")})},getParameterAgain:function(e,t,o,n){var l=this;o.sourceId==e&&this.$axios.$POST({api_name:t,params:n}).then(function(e){"success"==e.data.code?(o.exist,l.findMonitorDeviceStateDownList()):l.$message("获取失败")})},sonHandleCurrentChange:function(e){this.widgetInfo.pageSize=e.pageSize?parseInt(e.pageSize):this.widgetInfo.pageSize,this.widgetInfo.pageNo=e.pageNo?parseInt(e.pageNo):this.widgetInfo.pageNo,this.findMonitorDeviceStateDownList()},reset:function(e){this.formData={},this.findMonitorDeviceStateDownList(),this.widgetInfo.pageNo=1},lookFor:function(){this.findMonitorDeviceStateDownList()},isBtnShow:function(){var e=this.currentBtns;this.btns.forEach(function(element){e.forEach(function(e){e.name===element.name&&(element.isShow=e.isShow)})})}}},l=(o(832),o(17)),component=Object(l.a)(n,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"Crumbs"},[o("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[o("el-breadcrumb-item",[e._v("硬件平台")]),e._v(" "),o("el-breadcrumb-item",[e._v("下行控制")])],1)],1),e._v(" "),o("div",{staticClass:"main-wrap"},[o("div",{staticClass:"location"},[e._v("下行控制")]),e._v(" "),o("div",{staticClass:"main-container"},[o("el-form",{ref:"formData",staticClass:"hardware-form",attrs:{inline:!0,model:e.formData}},[o("el-form-item",{attrs:{label:"设备ID:",prop:"deviceId","label-width":e.labelWidth}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formData.deviceId,callback:function(t){e.$set(e.formData,"deviceId","string"==typeof t?t.trim():t)},expression:"formData.deviceId"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"运营中心:","label-width":e.labelWidth}},[o("el-select",{attrs:{placeholder:"全部",filterable:""},on:{change:e.changeSubCode},model:{value:e.formData.subCenterCode,callback:function(t){e.$set(e.formData,"subCenterCode","string"==typeof t?t.trim():t)},expression:"formData.subCenterCode"}},e._l(e.subCenterNames,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),o("el-form-item",{attrs:{label:"业主单位:",prop:"unitName","label-width":e.labelWidth}},[o("el-select",{attrs:{placeholder:"全部",filterable:""},model:{value:e.formData.unit,callback:function(t){e.$set(e.formData,"unit","string"==typeof t?t.trim():t)},expression:"formData.unit"}},e._l(e.units,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),o("el-form-item",{attrs:{label:"状态:","label-width":e.labelWidth}},[o("el-select",{attrs:{placeholder:"全部",filterable:""},model:{value:e.formData.onlineState,callback:function(t){e.$set(e.formData,"onlineState","string"==typeof t?t.trim():t)},expression:"formData.onlineState"}},e._l(e.onlineStates,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),o("el-form-item",{attrs:{label:"设备名称:",prop:"deviceName","label-width":e.labelWidth}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formData.deviceName,callback:function(t){e.$set(e.formData,"deviceName","string"==typeof t?t.trim():t)},expression:"formData.deviceName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"品牌:","label-width":e.labelWidth}},[o("el-select",{attrs:{placeholder:"全部"},model:{value:e.formData.brand,callback:function(t){e.$set(e.formData,"brand","string"==typeof t?t.trim():t)},expression:"formData.brand"}},e._l(e.brands,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),o("el-form-item",{attrs:{label:"设备型号:",prop:"model","label-width":e.labelWidth}},[o("el-input",{attrs:{placeholder:"请输入"},model:{value:e.formData.model,callback:function(t){e.$set(e.formData,"model","string"==typeof t?t.trim():t)},expression:"formData.model"}})],1),e._v(" "),o("el-form-item",{staticClass:"serch-btn",attrs:{label:" "}},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.lookFor()}}},[e._v("查询")]),e._v(" "),o("el-button",{attrs:{size:"small"},on:{click:function(t){return e.reset("formData")}}},[e._v("重置")])],1)],1),e._v(" "),o("div",{staticClass:"list-wrap"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading.lock",value:e.isLoading,expression:"isLoading",modifiers:{lock:!0}}],attrs:{data:e.tableData,stripe:"","show-overflow-tooltip":""}},[o("el-table-column",{attrs:{label:"设备ID",prop:"deviceId","show-overflow-tooltip":"",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"运营中心",prop:"subCenterName","show-overflow-tooltip":"",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"业主单位",prop:"unitName","show-overflow-tooltip":"",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"安装位置",prop:"deviceAddress","show-overflow-tooltip":"",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"设备名称",prop:"deviceName","show-overflow-tooltip":"",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"品牌",prop:"brand","show-overflow-tooltip":"",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"型号",prop:"model","show-overflow-tooltip":"",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"设备状态",prop:"onlineState","show-overflow-tooltip":"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",[e._v(e._s(e.transformOnlineState(t.row.onlineState)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"创建时间",prop:"createTime","show-overflow-tooltip":"",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"数据库协议/参数",prop:"exist","show-overflow-tooltip":"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",[e._v(e._s(e.transformExist(t.row.exist)))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作","show-overflow-tooltip":"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",[o("el-link",{directives:[{name:"show",rawName:"v-show",value:0==t.row.exist&&1==t.row.onlineState&&e.btns[0].isShow,expression:"scope.row.exist==0 && scope.row.onlineState==1 && btns[0].isShow"}],attrs:{type:"primary"},on:{click:function(o){return e.getParameter(t.row,t.$index)}}},[e._v("获取协议/参数")])],1),e._v(" "),o("div",[o("el-link",{directives:[{name:"show",rawName:"v-show",value:1==t.row.exist&&e.btns[1].isShow,expression:"scope.row.exist==1 && btns[1].isShow"}],attrs:{type:"primary"},on:{click:function(o){return e.toDetail(t.$index,t.row)}}},[e._v("下行")])],1)]}}])})],1)],1),e._v(" "),o("Pagination",{attrs:{widgetInfo:e.widgetInfo},on:{sonHandleCurrentChange:e.sonHandleCurrentChange}})],1)])])},[],!1,null,"fb4e1b5a",null);t.default=component.exports},478:function(e,t,o){"use strict";o(2),o(3),o(4),o(5);var n={props:{widgetInfo:Object},data:function(){return{}},methods:{handleSizeChange:function(e){this.pageSize=e,this.$emit("sonHandleCurrentChange",{pageSize:this.pageSize})},handleCurrentChange:function(e){this.$emit("sonHandleCurrentChange",{pageNo:e})}},mounted:function(){this.$emit("sonHandleCurrentChange",{pageSize:10,pageNo:1})}},l=o(17),component=Object(l.a)(n,function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-pagination",{attrs:{"current-page":this.widgetInfo.pageNo,"page-sizes":[10,15,20,25],"page-size":this.widgetInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:this.widgetInfo.total},on:{"size-change":this.handleSizeChange,"current-change":this.handleCurrentChange}})],1)},[],!1,null,null,null);t.a=component.exports},633:function(e,t,o){var content=o(833);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(14).default)("9cbce736",content,!0,{sourceMap:!1})},832:function(e,t,o){"use strict";var n=o(633);o.n(n).a},833:function(e,t,o){(e.exports=o(13)(!1)).push([e.i,".list-wrap[data-v-fb4e1b5a]{width:100%;overflow:hidden}.list-wrap[data-v-fb4e1b5a] .el-table{width:100%;padding:0;overflow:hidden}.list-wrap[data-v-fb4e1b5a] .el-table th{background:#f0f3f7}.list-wrap[data-v-fb4e1b5a] .el-table .el-table__body-wrapper{height:calc(100vh - 430px);overflow-y:auto}.hardware-form[data-v-fb4e1b5a]{font-size:0;padding:20px 20px 0}.hardware-form .el-form-item[data-v-fb4e1b5a]{width:20%;display:-webkit-inline-box;display:inline-flex;margin-right:0}.hardware-form .el-form-item .el-select[data-v-fb4e1b5a]{width:100%}.hardware-form .serch-btn button[data-v-fb4e1b5a]:first-child{margin-left:10px}[data-v-fb4e1b5a] .el-pagination{margin:0;padding-top:20px}@media screen and (max-width:1680px){.list-wrap[data-v-fb4e1b5a] .el-table .el-table__body-wrapper{height:calc(100vh - 410px)}}[data-v-fb4e1b5a] .el-table .el-table__body-wrapper{height:calc(100vh - 482px)!important}[data-v-fb4e1b5a] .el-table th>.cell{white-space:nowrap;word-break:break-all}[data-v-fb4e1b5a] .el-form .el-form-item__content{width:calc(100% - 100px)}@media screen and (max-width:1680px){[data-v-fb4e1b5a] .el-table .el-table__body-wrapper{height:calc(100vh - 462px)!important}}",""])}}]);